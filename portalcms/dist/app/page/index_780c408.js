"use strict";function regPage(){var e,t=document.querySelector("#expform .choose"),n=document.querySelector("#expform .city"),o=document.getElementById("expform2");o.setAttribute("action",api.basepath+api.api.userinsert),tool.listen(t,"click",function(t){n.style.display="block";var o=t||window.event;o.stopPropagation?o.stopPropagation():window.event&&(window.event.cancelBubble=!0),e=tool.listen(document,"click",function(){n.style.display="none",e&&e.remove()})}),tool.listen(n,"click",function(e){var t=e||window.event;t.stopPropagation?t.stopPropagation():window.event&&(window.event.cancelBubble=!0)}),n.innerHTML=city.create(),city.listenControl(function(o){t.value=o,n.style.display="none",e&&e.remove()});for(var l=document.querySelectorAll(".page-control > a"),a=0;a<l.length;a++)!function(e){tool.listen(l[e],"click",function(){if(currentPageIndex!=e&&!isAnimationRun){for(var t=0;t<l.length;t++)this!=l[t]&&(l[t].className="");this.className="active",changePage(e),head.setActive(e)}})}(a);var c=document.querySelector(".btn");tool.listen(c,"click",function(){changePage(3),l[3].className="active",head.setActive(3)});for(var i=document.querySelectorAll(".page"),a=0;a<i.length;a++)i[a].style.top=100*a+"%";pageslength=i.length;var r=document.querySelector(".wrap-index");tool.listen(r,"mousewheel",scroll),tool.listen(r,"DOMMouseScroll",scroll)}function scroll(e){var t=e.wheelDelta||e.detail;if(t>0){if(0==currentPageIndex)return;changePage(currentPageIndex-1),head.setActive(currentPageIndex)}else{if(currentPageIndex==pageslength-1)return;changePage(currentPageIndex+1),2>=currentPageIndex&&head.setActive(currentPageIndex)}}function changePage(e){if(!isAnimationRun){currentPageIndex=e,isAnimationRun=!0;for(var t=document.querySelectorAll(".page"),n=0;n<=t.length-1;n++){var o=100*-(e-n);animation(n,t[n],o,function(e){if(doneAnimationIndexs.push(e),doneAnimationIndexs.length==t.length){isAnimationRun=!1,doneAnimationIndexs=[];for(var n=document.querySelectorAll(".page-control > a"),o=0;o<n.length;o++)n[o].className="",n[currentPageIndex].className="active"}})}}}function animation(e,t,n,o){var l=t.style.top.substring(0,t.style.top.length-1)-0,a=200,c=(n-l)/(a/10),i=setInterval(function(){var l=t.style.top.substring(0,t.style.top.length-1)-0;l==n?(o(e),clearInterval(i)):t.style.top=l+c+"%"},10)}function page2Reg(){createHrmoudle()}function createHrmoudle(){var e='<!--\r\n* @Created Date       : 2016-11-11T15:54:05+08:00\r\n* @Last Modified time : 2016-12-01T10:07:00+08:00\r\n -->\r\n\r\n\r\n\r\n{{#.}}\r\n<div class="{{className}}">\r\n    {{#list}}\r\n          <div class="{{className}}" data-key="{{index}}">\r\n            <h2>{{cnName}}</h2>\r\n            {{#listp}}\r\n              <p>{{.}}</p>\r\n            {{/listp}}\r\n              <div  class="click-module" data-key="{{index}}">\r\n               <h1>{{cnName}}</h1>\r\n               <p>{{clickText}}</p>\r\n               <div class="bottom"><a href="javascript:void(0)" date-value="{{cnName}}">查看详情></a></div>\r\n              </div>\r\n          </div>\r\n    {{/list}}\r\n</div>\r\n{{/.}}\r\n';mustache.parse(e);var t=mustache.render(e,hrmodules),n=document.querySelector(".page2 .modules");n.innerHTML=t;for(var o=n.querySelectorAll(".module"),l=0;l<o.length;l++)!function(e){tool.mouseenter(o[e],function(){var t=o[e].querySelector(".click-module");t.style.display="block"}),tool.mouseleave(o[e],function(){var t=o[e].querySelector(".click-module");t.style.display="none"}),tool.listen(o[e],"click",function(){var t=o[e].getAttribute("class").split(" ")[1];window.location.href="app/page/product/product.html?ID="+t})}(l)}function page3Reg(){}function submit(){var e=document.getElementById("submitBtn"),t=document.getElementById("expform"),n=document.getElementById("errorTip"),o=document.getElementById("city"),l=document.getElementById("companyName"),a=document.getElementById("companyFormsId"),c=document.getElementById("storeNum"),i=(document.getElementById("userName"),document.getElementById("passWord"),document.getElementById("telephone")),r=document.getElementById("contactName"),s=document.querySelector(".select-show");tool.listen(e,"click",function(){var e=tool.validator(t);if(e.success){var u=new RegExp("[`~!@#$^&*()=|{}':;',\\[\\].<>/?~！@#￥……&*（）——|{}【】‘；：”“'。，、？%+_]");e.content[2].value>9999?n.innerHTML="门店数量最多为9999家！":e.content[1].value.length>60||u.test(e.content[1].value)?n.innerHTML="公司名称最长限度为60字符，且不能输入特殊字符！":e.content[4].value.length>40||u.test(e.content[4].value)?n.innerHTML="联系人最长限度为40字符，且不能输入特殊字符！":(uploadCharte(),o.value=e.content[0].value,l.value=e.content[1].value,c.value=e.content[2].value,i.value=e.content[3].value,r.value=e.content[4].value,a.value=s.getAttribute("data-index"),n.innerHTML="&nbsp;")}else n.innerHTML=e.errorMsg})}function uploadCharteBtn(){var e=document.getElementById("uploadCharteBtn"),t=document.getElementById("uploadDone"),n=document.querySelector(".showTpl"),o=(document.querySelector(".charter"),document.querySelector(".success")),l=document.querySelector(".closeSuccess"),a=document.getElementById("expform2"),c=document.getElementById("businessLicense");tool.listen(e,"click",function(){var e=document.createElement("iframe");e.style.display="none",e.name="upload",document.body.appendChild(e),e.onload=uploadSuccess,c.value?(a.submit(),loading.style.display="block",loadingWrap.style.display="block"):alert("请选择上传的图片！")}),tool.listen(t,"click",function(){n.style.display="none",o.style.display="none",loading.style.display="none",loadingWrap.style.display="none"}),tool.listen(l,"click",function(){n.style.display="none",o.style.display="none",loading.style.display="none",loadingWrap.style.display="none"})}function checkForm(){document.querySelector(".wrap-index")}function uploadCharte(){{var e=(document.getElementById("submitBtn"),document.getElementById("businessLicense")),t=document.getElementById("imgshow"),n=document.querySelector(".showTpl"),o=document.querySelector(".charter"),l=document.querySelector(".closeCharter"),a=document.querySelector(".charte-claim");document.querySelector(".success")}o.style.display="block",n.style.display="block",tool.listen(e,"change",function(){var n=navigator.appName,o=navigator.appVersion,l=o.split(";"),c=l[1].replace(/[ ]/g,"");if("Microsoft Internet Explorer"==n&&"MSIE8.0"==c||"MSIE9.0"==c)a.innerHTML="您的浏览器版本过低不能预览图片！";else if(e.files&&e.files[0])if(e.files[0].size/1024>50)alert("图片大小限制为50KB！");else{var i=(URL.createObjectURL(e.files[0]),new FileReader);i.onload=function(e){e&&t.setAttribute("src",e.target.result)},i.readAsDataURL(e.files[0]),a.style.display="none"}}),tool.listen(l,"click",function(){o.style.display="none",n.style.display="none",loading.style.display="none",loadingWrap.style.display="none"})}function loadCompany(){var e=document.querySelector(".select-list");tool.ajax({url:"selectcompanyforms",data:""},function(t){for(var n=0;n<t.length;n++){var o=document.createElement("li");o.innerHTML=t[n].formsName,o.setAttribute("data-index",t[n].id),e.appendChild(o)}showSelect()},function(){})}function checkUsername(){var e=document.getElementById("userName2"),t=document.getElementById("errorTip");e.onblur=function(e){var n={userName:e.target.value};tool.ajax({url:"validateusername",data:n},function(){t.innerHTML="&nbsp;"},function(){t.innerHTML="用户名重复"})}}function uploadSuccess(){console.log(1);{var e=document.getElementsByTagName("iframe")[0],t=document.querySelector(".charter"),n=document.querySelector(".success");setTimeout(function(){if(e.contentDocument.body.innerHTML){var o=JSON.parse(e.contentDocument.body.innerHTML).success;"false"!=o?(t.style.display="none",n.style.display="block",loading.style.display="none",loadingWrap.style.display="none"):(loading.style.display="none",loadingWrap.style.display="none",alert("请上传PNG JPG JEPG格式的图片!"))}else;document.body.removeChild(e)},1e3)}}function showSelect(){var e,t=document.querySelector(".select-show"),n=document.querySelector(".select-list"),o=document.querySelectorAll(".select-list li");tool.listen(t,"click",function(t){n.style.display="block";var o=t||window.event;o.stopPropagation?o.stopPropagation():window.event&&(window.event.cancelBubble=!0),e=tool.listen(document,"click",function(){n.style.display="none",e&&e.remove()})});for(var l=0;l<o.length;l++)tool.listen(o[l],"click",function(){t.innerHTML=this.innerHTML,t.setAttribute("data-index",this.getAttribute("data-index")),n.style.display="none"})}function targetPage(){var e=window.location.search.substr(1).split("=")[1];e&&changePage(e)}var mustache=require("lib/mustache.min"),head=require("app/component/head/head"),tool=require("app/tool/Tool"),city=require("app/component/city/city"),api=require("app/config/api");head.setActive(0),head.setNavClickCallBack(function(e){0!=e&&changePage(e)});var currentPageIndex=0,isAnimationRun=!1,doneAnimationIndexs=[],pageslength=0,loading=document.querySelector(".loading"),loadingWrap=document.querySelector(".loading-wrap"),cors=[5800,6800,9800],hrmodules=[{className:"module-left",list:[{className:"module org",cnName:"组织和员工",listp:["完美解决企业架构问题，重新定义高效企业办公。"],clickText:"完美解决企业架构问题，重新定义高效企业办公。"},{className:"module pay",cnName:"薪酬管理",listp:["打造全新智能薪酬管理体系，完美解决薪资计算、统计、发放问题。"],clickText:"打造全新智能薪酬管理体系，完美解决薪资计算、统计、发放问题。"},{className:"module power",cnName:"权限管理",listp:["帮助企业进行精细化分工，权限下发及回收。"],clickText:"帮助企业进行精细化分工，权限下发及回收。"}]},{className:"module-right",list:[{className:"module time",cnName:"时间管理",listp:["灵活有效的提升企业人员工作效率。"],clickText:"灵活有效的提升企业人员工作效率。"},{className:"module proval",cnName:"审批",listp:["一键完成审批流程，构建成熟人事系统，搭建轻盈管理。"],clickText:"一键完成审批流程，构建成熟人事系统，搭建轻盈管理。"},{className:"module move",cnName:"移动端",listp:["为企业提供真正便捷、高效的HR移动办公可能。"],clickText:"为企业提供真正便捷、高效的HR移动办公可能。"}]}];regPage(),page2Reg(),page3Reg(),submit(),uploadCharteBtn(),loadCompany(),targetPage();